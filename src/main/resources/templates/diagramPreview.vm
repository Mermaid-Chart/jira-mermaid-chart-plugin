<!DOCTYPE html>
<html>
  <head>
    <title>$i18n.getText("mermaid-chart-ops.diagrams-page-title")</title>
    <meta name="decorator" content="atl.general"/>
    $webResourceManager.requireResource("com.plugin.mermaidchart.mermaidchart-plugin:mermaidchart-plugin-resources")
  </head>
  <body>
    <div class="main">
      <!-- Sidebar-->
      <div id="sidebar-wrapper">
        <div class="list-group">
          <a class="list-group-item" href="/jira/plugins/servlet/resourceslisting?userkey=$userkey">Mermaid Chart</a>
          <a class="list-group-item active" href="/jira/plugins/servlet/diagrampreview">Preview Diagram</a>
        </div>
    	</div>
      <div>
        <h1>$title</h1>
        <div id="mer" class="mermaid responsive ">
            $code
        </div>
        <script>
          mermaid.initialize({ startOnLoad: true }); 
        </script>
        <button onclick="syncImage(event, '$documentID', '$title', '$userkey')">sync</button>
        <button onclick="editImage('$baseURL', '$projectID', '$documentID')">Edit</button>
        <button onclick="insertImageToJiraAction('$title')">Insert to Jira</button>
        <div id="images">
          <canvas id="canvasEl" height="0"></canvas>
          <img width="100%" height="100%" id="prerenderImage"/>
        </div>
      </div>
    </div>
  </body>
</html>